\chapter{3-D Deterministic Transport Methods}{\label{ch:3-D Transport}
  \input{macros/multigroup.tex}
  \input{macros/DiscreteOrdinates.tex}
  \input{macros/MOC.tex}
  \def\figpath{chapters/TransportMethods/figures/}
  \graphicspath{ {\figpath} }

  Until recently, whole-core neutronics calculations were carried out primarily through a two-step procedure.
  First, a transport method was used to compute homogenized cross section data for assemblies, and then 3-D diffusion was used to solve the problem.
  More recently, however, research has been focused on a one-step approach, so called direct whole-core transport.
  In such an approach, the 3-D reactor is directly modeled using transport methods.
  There are many different transport methods which are currently being researched; this chapter seeks to give an overview of several state-of-the-art 3-D transport methods.

  \section{S\texorpdfstring{$P_N$}{PN}}{\label{sec:3T:SPN}
    \DeclareDocumentCommand{\xstr}{ m }{\CrossSection_{tr,#1}}
    \DeclareDocumentCommand{\xsa}{}{\CrossSection_{a}}
    \DeclareDocumentCommand{\xst}{}{\CrossSection_{t}}
    \DeclareDocumentCommand{\xss}{ m }{\CrossSection_{s,#1}}
    \DeclareDocumentCommand{\fluxm}{ m }{ \phi_{#1} }
    \DeclareDocumentCommand{\Q}{}{Q}
    \DeclareDocumentCommand{\D}{}{}

    The \acf{SPN} method was introduced by \citet{SPN} in 1961, and was seen as a middle ground between diffusion and transport \cite{Mcclarren2010}.
    The \ac{SPN} equations were first derived by examining the form of the 1-D \ac{PN} equations; in fact, the 1-D \ac{SPN} and \ac{PN} equations are equivalent.
    While the original derivation \citet{SPN} lacked theoretical justification, the \ac{SPN} method has since been shown to be an asymptotic correction to standard diffusion theory \cite{Larsen2010}.

    The mono-energetic planar geometry \ac{PN} equations can be written as
    \begin{subequations}\label[subeqs]{eqs:eqs}
      \begin{equation}\label{eq:SPN:Planar PN}
        \deriv{}{z}\left[\frac{l}{2l+1}\fluxm{l-1} + \frac{l+1}{2l+1}\fluxm{l+1}\right] + \xst\fluxm{l} = \xss{l}\fluxm{l} + \Q\delta_{l,0}, \quad\text{for}\quad 0\leq l\leq N,
      \end{equation}
      where $\xss{l}$ is the lth order scattering moment and $\Q$ is either an external source or fission source.
    \end{subequations}
    The expansion is generally truncated by assuming that $\fluxm{N+1}=0$.

    The 1-D $P_1$ equation can be written as
    \begin{equation}\label{eq:SPN:P1}
      -\deriv{}{z}\D\deriv{}{z}\fluxm{0} + \xst\fluxm{0} = \xss{0}\fluxm{0} + \Q,
    \end{equation}
    where
    \begin{equation}\label{eq:SPN:Diffusion Coefficient}
      \D \defined \frac{1}{3(\xst-\xss{1})}.
    \end{equation}
    The 3-D $P_1$ equations simply replace the derivative term operator of \cref{eq:SPN:P1} with the 3-D diffusion operator,
    \[
      \deriv{}{z}\D\deriv{}{z} \to \grad\vdot\D\grad,
    \]
    yielding the 3-D $P_1$ (diffusion) equation:
    \begin{equation}\label{eq:SPN:3D Diffusion}
      -\grad\vdot\D\grad\fluxm{0} + \xst\fluxm{0} = \xss{0}\flyxm{0} + \Q.
    \end{equation}

    This simple relation between 1-D and 3-D equations only holds for the special $P_1$ case.
    The \ac{SPN} method uses a similar modification for higher-order $P_N$ equations.
    This results in some lost accuracy compared to \ac{PN}, but the \ac{SPN} equations are significantly simpler to solve \cite{SPN,Mcclarren2010}.
    Unlike \ac{PN}, \ac{SPN} equations do not converge to the transport solution as $N\to\infty$, but do generally have higher accuracy than diffusion (for orders of $N > 1$).
    Generally, S$P_3$ or S$P_5$ are considered to have sufficient accuracy, and are generally less computationally intensive than transport methods.

    The mono-energetic \ac{SPN} equations can be written as
    \begin{subequations}\label[subeqs]{eqs:SPN:SPN}
      \begin{equation}\label{eq:SPN:SPN 0}
        -\grad\vdot\frac{1}{3\xstr{1}}\grad\fluxm{0} -\grad\vdot\frac{2}{3\xstr{1}}\grad\fluxm{2} + \xstr{0}\fluxm{0} = \Q,
      \end{equation}
      \begin{aequation}\label{eq:SPN:SPN N}
        &-\grad\vdot\left(\frac{n(n-1)}{(2n+1)(2n-1)\xstr{n-1}}\right)\grad\fluxm{n-2}\\
        &-\grad\vdot\left(\frac{(n+1)(n+2)}{(2n+1)(2n+3)\xstr{n+1}}\right)\grad\fluxm{n+2}\\
        &-\grad\vdot\left(\frac{n^2}{(2n+1)(2n-1)\xstr{n-1}} + \frac{(n+1)^2}{(2n+1)(2n+3)\xstr{n+1}}\right)\grad\fluxm{n}\\
        &+\xstr{n}\fluxm{n} = 0, \quad{\text{for}\quad n=2,4,...,N-1},
      \end{aequation}
      where
      \begin{equation}\label{eq:SPN:xstr}
        \xstr{n} \defined \CrossSection_t - \CrossSection_{s,n}.
      \end{equation}
    \end{subequations}

    [CURRENT RESEARCH]
  }

  % Here just to make sure previous macros didn't screw anything up
  \input{macros/multigroup.tex}
  \input{macros/DiscreteOrdinates.tex}
  \input{macros/MOC.tex}

  \section{2D/1D Methods}{\label{sec:3T:2D/1D Methods}
    The 2D/1D methods were first developed by researchers at \ac{KAIST} \cite{Cho2002} and \ac{KAERI} \cite{DeCART}, in the CRX and DeCART codes, respectively.
    Though different, these two methods followed the same fundamental approach to solving 3-D reactor transport problems:
    \begin{enumerate}
      \item{Divide the core into separate axial slices/planes,}
      \item{Perform 2-D transport calculations within each plane,}
      \item{Couple the planes with transverse leakages.}
    \end{enumerate}
    These methods were based on the assumption that reactors may be very heterogeneous in the radial direction, but in the axial direction they are relatively homogeneous.
    The primary difference between these two methods is in the transverse leakage terms; in CRX the transverse leakages are anisotropic, but in DeCART the leakages are isotropic.
    To distinguish these methods, they will be referred to as anisotropic and isotropic 2D/1D methods.

    Following the relative success of these methods, other research groups have followed in their paths.
    nTRACER \cite{Jung2009}, and MPACT \cite{MPACT2016} used the isotropic 2D/1D method.
    The PANX [CITATION], STREAM \cite{Zheng2017}, and APOLLO3 \cite{Faure2018} have also implemented 2D/1D methods.

    \citet{Stimpson2015} implemented an anisotropic 2D/1D method in MPACT using a Fourier expansion of the azimuthal angles for the axial and radial transverse leakages.
    \citet{Jarrett2018} further improved upon \citetp{Stimpson2015} work by introducing a 2D/1D method using $P_3$ in the axial direction.

    [FAILINGS]
    [DERIVATION]





    % 2D/1D methods originally developed in Korea - KAIST and KAERI in the early 2000's.
    % Implemented in CRX, DeCART, nTracer.
    % Implemented MPACT [Shane's thesis] - anisotropic TL?
    % PANX, STREAM, APOLLO3
    % Isotropic vs Anisotropic - performance vs accuracy
    % Failings of the 2D/1D method

    % Derivation:
    %   - Radial transport (MoC)
    %   - Coupled by transverse leakages
    %   - Planar integration -> flat in each plane
    %   - homogenization
    %   - stability / relaxation
    %   - transverse leakage splitting
  }

  \section{Extruded 3-D Methods}{\label{sec:3T:Extruded 3-D Methods}
    Proteus - FEM
    STREAM - Linear orthogonal polynomials
    APOLLO - ?
    Nick H. - Legendre Expansion
    SooYoung - Diamond-Difference
  }

  \section{Method of Characteristics}{\label{sec:3T:Method of Characteristics}
    The \acf{MOC} is a technique used in mathematics to solve \acp{PDE}, by transforming a \ac{PDE} into a system of \acp{ODE}.
    The method was first applied to the neutron transport problem by \citeauthor{Askew1972} in 1972 \cite{Askew1972}, but only began to see real use in the 1980's \cite{Halsall1980}.
    The \ac{MOC} transforms the transport equation into the characteristic form, by examining the equation along straight neutron paths through the spatial domain.

    By examining the equation along one of these characteristic ``tracks'' or ``rays'', the average angular flux along the track within a cell can be calculated.
    The scalar flux can then be found by collecting the average angular flux along all tracks passing through this region, in a numerical integration over space and angle.

    Like the \ac{CP} method, \ac{MOC} is able to handle completely arbitrary geometry; however, unlike the \ac{CP} method, it is also able to account for anisotropic scattering in a straightforward manner.
    Additionally, the \ac{MOC} does not produce the large matrices in realistic applications as the \ac{CP} method does.
    For problems that contain more than a few hundred cells, the \ac{MOC} is generally preferred over \ac{CP} methods \cite{Hebert2010}.

    The \ac{CDP} is a method similar to both \ac{CP} method and the \ac{MOC} \cite{Hong1999,Liu2014}.
    The \ac{CDP} uses ray-tracing to evaluate transmission probabilities between cells.
    However, it only considers transmission probabilities between cells which are traversed by a shared characteristic ray, rather than considering the transmission probability between all cells as in the \ac{CP} methods.
    This significantly cuts down on the computational resources required by traditional \ac{CP} methods.
    This method has also shown improvements over \ac{MOC} in cases with few unique geometries and constant material properties throughout the simulation; however these conditions are not applicable in problems of interest to industry.

    The \ac{MOC} is the primary subject of this thesis work.
    As such, \cref{ch:The Method of Characteristics} has been devoted to the details of the method, and \cref{sec:3T:Ray-Tracing} expands upon the details of current ray-tracing techniques used in \ac{MOC}.
    \Cref{ch:Improved Linear Source Formulation for Multi-physics and 2D/1D Applications} details improvements made to the \ac{MOC} in this thesis work, and \cref{ch:MacroRay Three-Dimensional Ray-tracing Technique} details a newly investigated ray-tracing method.
  }

  \printbibliography
}
