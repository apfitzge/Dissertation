\chapter{The Method of Characteristics}{\label{ch:The Method of Characteristics}
    \input{macros/multigroup.tex}
    \input{macros/DiscreteOrdinates.tex}
    \input{macros/MOC.tex}
    \def\figpath{chapters/03/figures/}
    \graphicspath{ {\figpath} }

    \section{Fundamentals}{\label{sec:MOC:Fundamentals}
        The \acf{MOC} is a technique used in mathematics to solve \acp{PDE}, by transforming a \ac{PDE} into a system of \acp{ODE}.
        The method was first applied to the neutron transport equation by \citeauthor{Askew1972} in 1972 \cite{Askew1972}, but only began to see real use in the 1980's \cite{Halsall1980}.
        The \ac{MOC} transforms the transport equation into the characteristic form, by following the equation along straight neutron paths through the spatial domain.
        For brevity, the derivation of this method will begin with the multigroup \ac{SN} $k$-eigenvalue transport equation with spatially discretized mesh with constant material properties within each cell.
        Here, the spatial derivatives have not yet been discretized.
        \begin{equation}\label{eq:MOC:SSMGFS Transport}
            \left[\dirm\vdot\grad + \xst\right]\aflux[mi][g][\loc] = \rfourpi\source[mi][g][\loc],
        \end{equation}
        \begin{equation*}
            \forall\loc\in\Region, \quad \forall m \in \angquad, \quad \forall i, g,
        \end{equation*}
        where $\Region$ is the spatial cell, $\angquad$ is the directional quadrature, as described in \cref{sssec:NTT:Directional Discretization}, and the fixed-source, $
        \source[mi][g][\loc]$ can be found by applying the discrete-to-moment operator, $\FluxToSource$, defined by
        \begin{equation}\label{eq:MOC:LSA:Flux To Source Operator}
          \FluxToSource(f) \defined
            \suml[\gprime]\suml[\ell=0][L]\suml[n=-\ell][\ell]\SH[\ell][n][\dirm]\xss[\ell]f^{\ell,\gprime}_{n,i}(\loc)
            + \frac{\spect}{\keff}\suml[\gprime]\nufis f^{\gprime}_{i}(\loc),
        \end{equation}
        to get
        \begin{equation}\label{eq:MOC:Source}
            \source[mi][g][\loc] \defined
                \left[\suml[\gprime]\suml[\ell=0][L]\suml[n=-\ell][\ell]\SH\xss[\ell]\afluxmom(\loc) + \frac{\spect}{\keff}\suml[\gprime]\nufis\sflux[\gprime](\loc)\right],
        \end{equation}
        where $L$ is the maximum scattering order.
        If $L$ were infinite, there would not any additional approximation to the scattering source; however, the first several orders have the most effect on the figures of merit, and in practice the sum is truncated with $L$ typically being less than five.

        Consider a point, $\loc_0$, and a line passing through this point in direction $\dirm$.
        Any location along this \emph{characteristic} line (also referred to as a ray, or track), can be described as
        \begin{equation}\label{eq:MOC:Characteristic Ray}
            \loc = \loc_0 + \len\dirm,
        \end{equation}
        where $\len$ is the distance along the track from $\loc_0$.
        Applying this transformation, \cref{eq:MOC:SSMGFS Transport} is put into the characteristic form
        \begin{equation}\label{eq:MOC:Characteristic Form Deriv 1}
            \left[\deriv{}{\len} + \xst\right]\aflux[mi][g][\loc_0 + \len\dirm] = \rfourpi\source[mi][g][\loc_0 + \len\dirm].
        \end{equation}
        As stated in \cref{sec:NTT:Neutron Transport Equation}, reactor physicists are generally interested in spatially and directionally integrated angular flux quantities rather than the angular flux along a single path.
        Thus typical in the \ac{MOC} to have many different characteristic tracks through our problem; in this work separate tracks will be subscripted with the index $k$.
        Each track is broken up into track-segments by considering the segments contained within each computational cell.
        The characteristic form of the transport equation then becomes
        \begin{equation}\label{eq:MOC:MOC Equation Generic}
            \left[\deriv{}{\len} + \xst\right]\aflux = \rfourpi\source[mi][g][\len],
        \end{equation}
        \begin{equation*}
            \forall \len \in [0,\segl], \forall m\in\angquad, \forall i,k,g,
        \end{equation*}
        where $\segl$ is the total length of the track-segment, as depicted in \cref{fig:MOC:MOC Coordinate System}.

        \begin{figure}[h]
            \centering
            \def\svgwidth{0.4\linewidth}
            \input{\figpath/MOCCoordinateSystem.pdf_tex}
            \caption{Depiction of a single characteristic track through a cell $i$.}
            \label{fig:MOC:MOC Coordinate System}
        \end{figure}

        \Cref{eq:MOC:MOC Equation Generic} can be solved analytically along a characteristic track-segment using an integrating factor,
        \begin{equation}\label{eq:MOC:Integrating Factor}
            M(\len) = \exp\!\left(\intl[0][\len]\xst\dif{s'}\right) = \exp\!\left(\opt\right),
        \end{equation}
        where the \emph{optical thickness}, $\opt$, can be simplified as
        \begin{equation}\label{eq:MOC:Optical Thickness Definition}
            \opt \defined \xst\len,
        \end{equation}
        \begin{equation*}
          \forall \len \in [0,\segl],
        \end{equation*}
        assuming constant properties along the track-segment.
        Using this integrating factor, the generic solution to the \ac{MOC} equation, given in \cref{eq:MOC:MOC Equation Generic}, is
        \begin{equation}\label{eq:MOC:MOC Generic Solution}
            \aflux = \afluxin\exp\!\left(-\opt\right) + \intl[0][\len]\rfourpi\source[mi][g][\len']\exp\!\left(-\xst\left[\len-\len'\right]\right)\dif{s'},
        \end{equation}
        where $\afluxin$ is the incident angular flux, $\aflux[mki][g][0]$.
        If a source shape is provided, \cref{eq:MOC:MOC Generic Solution} can be evaluated for every track-segment in the problem.
        The next subsection introduces formal methods to approximate the integration of quantities over both space and direction.
        These procedures can be used to determine the scalar flux or other quantities necessary in \ac{MOC} calculations.

        \subsection{Track-Based Integration}{\label{ssec:MOC:Track-Based Integration}
            Determining the angular flux along a single characteristic track is typically not very useful for reactor physics calculations.
            It is most often necessary to evaluate reaction rates, and therefore the scalar flux through integration of the angular flux.
            This section aims to provide a formal basis for the integration process used in the \ac{MOC} for transport calculations.

            \begin{figure}[h]
                \centering
                \def\svgwidth{0.4\linewidth}
                \input{\figpath/MOCTracks.pdf_tex}
                \caption{Example characteristic tracks (2D) through a cell for a single direction.}
                \label{fig:MOC:MOC Tracks}
            \end{figure}

            The \ac{MOC} is based on the \acf{SN} approximation; integration over the directional variable simply becomes a quadrature integration:
            \begin{equation}\label{eq:MOC:Directional Quadrature Integration}
                \intl[\fourpi]f(\dir)\ddir \approx \fourpi\suml[m]\wt[m]f(\dirm).
            \end{equation}
            Within a cell, $\Region$, there are many characteristic track-segments for each direction in the directional quadrature, as is shown for a single direction in \cref{fig:MOC:MOC Tracks}.
            Thus, the spatial discretization is different for each direction, and spatial integration is linked with the directional integration.
            For a single direction, the integration over the spatial domain can be approximated by the weighted summation of track-averaged values, with the weight being equal to the area of the track-segment.
            The average value of a function, $f(\loc,\dirm)$, along a track-segment is denoted as
            \begin{equation}\label{eq:MOC:Track-Averaged Definition UnRenormalized}
                \MOCTrackIntegral{f(\loc,\dirm)} \defined \frac{1}{\segl}\intl[0][\segl]f(\len,\dirm)\dif{\len},
            \end{equation}
            where $\segl$ is the total length of the track-segment.
            The spatial integration for a single direction becomes
            \begin{equation}\label{eq:MOC:Spatial Averaging Definition UnRenormalized}
                \frac{1}{V_i}\intl[\loc\in\Region]f(\loc,\dirm)\dif^3{\loc} \approx \MOCSingleAngleIntegral{f(\loc,\dirm)} \defined \frac{1}{V_i}\suml[k]\tA[mki]\segl\MOCTrackIntegral{f(\loc,\dirm)} ,
            \end{equation}
            where $\tA[mki]$ is the cross-sectional area of the track (width in 2-D).
            In this notation, the integral is divided by the volume such that $\MOCSingleAngleIntegral{f}$ is approximately the mean value in the region, for the direction $\dirm$.
            Finally, an integration over both space and angle can be defined as
            \begin{equation}\label{eq:MOC:Spatial and Directional Integration Definition}
                \MOCIntegral{f(\loc,\dir)} = \fourpi\suml[m]\wt[m]\MOCSingleAngleIntegral{f(\loc,\dirm)}.
            \end{equation}

            These integrations have been expressed as 3-D \ac{MOC} equations.
            The general form remains the same for 2-D calculations, with minor changes.
            The spatial integration, \cref{eq:MOC:Spatial Averaging Definition UnRenormalized}, requires an additional scaling factor ($\sin(\Polar_p)$), and the volume, $V_i$, is the area of the cell:
            \begin{equation}
              \label{eq:MOC:Spatial Averaging Definition UnRenormalized 2D}
              \frac{1}{V_i}\intl[\loc\in\Region]f(\loc,\dirm)\dif^3{\loc} \approx \MOCSingleAngleIntegral{f(\loc,\dirm)} \defined \frac{\sin(\Polar_p)}{V_i}\suml[k]\tA[mki]\segl\MOCTrackIntegral{f(\loc,\dirm)}
            \end{equation}
            The scaling factor is necessary (but not sufficient) for the integrated cell area to be preserved for each polar angle.
        }
        \subsection{Track-Length Renormalization}{\label{sec:MOC:Track-Length Renormalization}
            In general, the spatial integration described in \cref{ssec:MOC:Track-Based Integration} does not preserve the cell volume; this is visually apparent in \cref{fig:MOC:MOC Tracks}.
            In order to preserve spatial volumes within a cell, track-lengths are often ``renormalized''.
            As the area of each ray, $\tA[mki]$ approaches zero, the renormalization becomes irrelevant; thus it is only of consequence when rays have relatively coarse spacing between each other.
            There are three renormalization methods which become obvious through the notation presented in \cref{ssec:MOC:Track-Based Integration}:
            \begin{enumerate}
                \item{segment-volume preservation}
                \item{direction-volume preservation}
                \item{volume preservation}
            \end{enumerate}

            Track-length renormalization involves adjusting the lengths of track-segments such that volume is preserved.
            Let us define a renormalization factor, $\renorm[mki]$, such that the renormalized track-length is given by
            \begin{equation}\label{eq:MOC:Track-Length Renormalization}
                \nsegl = \renorm[mki]\segl.
            \end{equation}
            The spatial integration schemes given by \cref{eq:MOC:Track-Averaged Definition UnRenormalized,eq:MOC:Spatial Averaging Definition UnRenormalized} become
            \begin{subequations}\label{eq:MOC:Renormalized Spatial Integration Definition}
                \begin{equation}\label{eq:MOC:Renormalized Track-Averaged Definition}
                    \MOCTrackIntegral{f(\loc,\dirm)} \defined \frac{1}{\nsegl}\intl[0][\nsegl]f(\len,\dirm)\dif{\nlen},
                \end{equation}
                and
                \begin{equation}\label{eq:MOC:Renormalized Spatial Averaging Definition}
                    \MOCSingleAngleIntegral{f(\loc,\dirm)} \defined \frac{1}{V_i}\suml[k]\tA[mki]\nsegl\MOCTrackIntegral{f(\loc,\dirm)},
                \end{equation}
                where the spatial variable $\loc$ can now be written as a function of the renormalized track-distance, $\nlen$, as
                \begin{equation}\label{eq:MOC:Renormalized Location Variable}
                    \loc =  \locIn + \nlen\dirm / \renorm[mki],
                \end{equation}
                where $\locIn$ is the starting point of the track-segment.
            \end{subequations}

            Segment-volume preservation is a renormalization method in which the track-length is adjusted such that the analytic volume within the cross-sectional area of each track-segment is preserved.
            This renormalization technique is the most ``correct'' method of renormalization, but is very expensive as each track is renormalized separately.
            It is also more difficult to implement, as the analytic area of each track-segment must be found.
            To the best of our knowledge, this method is not implemented in any production-level \ac{MOC} code.

            Direction-volume preservation is the next ``most-correct'' renormalization technique.
            In this method, every mono-directional spatial integration should preserve the cell volume, i.e.
            \begin{equation}\label{eq:MOC:Angle-Volume Preservation}
                \MOCSingleAngleIntegral{1} = 1.
            \end{equation}
            This constraint leads to the renormalization factor given by
            \begin{equation}\label{eq:MOC:Direction-Dependent Renormalization}
                \renorm[mi] = \frac{V_i}{\suml[k]\tA[mki]\segl}.
            \end{equation}
            This method is significantly less expensive in terms of memory, computational time, and difficulty of implementation.

            The simplest renormalization technique, volume preservation, only preserves the volume over the spatial and directional integration, i.e.
            \begin{equation}\label{eq:MOC:Volume Preservation}
                \MOCIntegral{1} = \fourpi.
            \end{equation}
            This constraint leads to the renormalization factor given by
            \begin{equation}\label{eq:MOC:Region Renormalization}
                \renorm[i] = \frac{V_i}{\suml[m]\wt[m]\suml[k]\tA[mki]\segl}.
            \end{equation}

            Renormalization is not the only technique used for volume preservation.
            Another method is to use the numerical volume, $\suml[k]\tA[mki]\segl$ in place of $V_i$ in \cref{eq:MOC:Spatial Averaging Definition UnRenormalized}.
            This seems to be a more consistent method; however, a detailed comparison of these methods has not taken place, to the best of our knowledge.
            The renormalization technique generally seems to be the faster approach, and is the approach used in MPACT \cite{Collins2016}, which is used extensively in this work.
        }
    }
    \section{The Flat-Source Approximation}{\label{sec:MOC:FSA}
        The simplest approximation to the spatial shape of the source, $\source[mi][g][\loc]$, within each cell is the \acf{FSA}.
        The \ac{MOC} has been widely used in lattice physics and neutron transport codes \cite{Knott2010}, many of which have utilized the \ac{FSMOC} \cite{Halsall1980,Hong1998,Saji2000,Smith2002,Sugimura2006,Masiello2008,Boyd2014,Collins2016}.

        \subsection{Derivation}{\label{ssec:MOC:FSA:Derivation}
            The \ac{FSA} is simply the assumption that within each cell, $\Region$, the source, $\source[mi][g][\loc]$, is uniform.
            This can be expressed as
            \begin{equation}\label{eq:MOC:FSA:Source Shape}
                \source[mi][g][\loc] \approx \srcF[mi] = \srcF + \suml[\ell=0][L]\suml[n=-\ell][\ell]\SH[\ell][n][\dirm]\srcF[i,\ell][g,n]
            \end{equation}
            Thus, to get a source in this form, \cref{eq:MOC:Source} requires that the region averaged scalar flux and higher-order angular moments (up to order $L$) be determined.
            In mathematical terms, the flat-source can be determined as
            \begin{equation}\label{eq:MOC:FSA:Source Computation}
                \srcF[mi] =
                    \left[
                        \suml[\gprime]\suml[\ell=0][L]\suml[n=-\ell][\ell]\SH[\ell][n][\dirm]\xss[\ell]\afluxmom[\gprime]
                        + \frac{\spect}{\keff}\suml[\gprime]\nufis\sflux[\gprime]
                    \right],
            \end{equation}
            where the $\sflux[\gprime]$ is the region-averaged scalar flux, and $\afluxmom[\gprime]$ are the region-averaged angular moments of the flux.

            In order to get these region-averaged flux moments, the spatial and directional integration operators, introduced in \cref{ssec:MOC:Track-Based Integration}, are used.
            \begin{subequations}\label[subeqs]{eqs:MOC:FSA:Region-Averaged Flux Moments Definition}
                The region-averaged scalar flux is given by
                \begin{equation}\label{eq:MOC:FSA:Region-Averaged Scalar Flux Definition}
                    \sflux = \MOCIntegral{\aflux[][g][]} = \frac{\fourpi}{V_i}\suml[m]\wt[m]\suml[k]\nsegl\tA[mki]\MOCTrackIntegral{\aflux[][g][]},
                \end{equation}
                and the higher-order angular moments of the flux are given by
                \begin{equation}\label{eq:MOC:FSA:Region-Averaged Angular Moments of Flux Definition}
                    \afluxmom[g] = \MOCIntegral{\SH\aflux[][g][]} = \frac{\fourpi}{V_i}\suml[m]\wt[m]\SH[\ell][n][\dirm]\suml[k]\nsegl\tA[mki]\MOCTrackIntegral{\aflux[][g][]}.
                \end{equation}
            \end{subequations}

            To evaluate these flux moments, the track-averaged angular flux, $\MOCTrackIntegral{\aflux[][g][]}$, must be found.
            By applying the \ac{FSA}, \cref{eq:MOC:MOC Equation Generic} becomes
            \begin{equation}\label{eq:MOC:FSA:Characteristic Form}
                \left[\deriv{}{\nlen} + \xst\right]\aflux[mki][g][\nlen] = \tsrcF[mi],
            \end{equation}
            where
            \begin{equation}
              \label{eq:MOC:FSA:Track Average Source}
              \tsrcF[mi] \defined \rfourpi\srcF[mi].
            \end{equation}
            This can be solved analytically for the angular flux along the track,
            \begin{subequations}\label[subeqs]{eqs:MOC:FSA:Angular Flux Solution}
                \begin{equation}\label{eq:MOC:FSA:Angular Flux Solution}
                    \aflux[mki][g][\nlen] = \afluxin + \left(\frac{\tsrcF[mi]}{\xst} - \afluxin\right)F_1(\opt),
                \end{equation}
                where
                \begin{equation}\label{eq:MOC:FSA:F1}
                    F_1(\opt) \defined 1 - \exp(-\opt),
                \end{equation}
                and $\opt$ is the (renormalized) optical thickness,
                \begin{equation}\label{eq:MOC:FSA:Optical Thickness}
                    \opt \defined \nlen\xst.
                \end{equation}
            \end{subequations}

            One approach to find $\MOCTrackIntegral{\aflux[][g][]}$, is to perform integration of \cref{eq:MOC:FSA:Angular Flux Solution} to evaluate the track-average value, resulting in
            \begin{equation}\label{eq:MOC:FSA:Track-Averaged Angular Flux Explicit}
                \MOCTrackIntegral{\aflux[][g][]} = \frac{\tsrcF[mi]}{\xst} - \left(\frac{\tsrcF[mi]}{\xst} - \afluxin\right)\frac{F_1(\segopt)}{\segopt}.
            \end{equation}
            This approach will be referred to as \emph{explicit}, as the moment's integral is explicitly evaluated.
            Another, approach, which in the author's opinion is simpler, is use the track-averaging operator on the characteristic form of the transport equation, \cref{eq:MOC:FSA:Characteristic Form}, which simplifies to
            \begin{equation}\label{eq:MOC:FSA:Track-Averaged Angular Flux Implicit}
                \MOCTrackIntegral{\aflux[][g][]} = \frac{\tsrcF[mi]}{\xst} + \frac{\afluxin-\afluxout}{\segopt}.
            \end{equation}
            This approach will be referred to as \emph{implicit}, as the moment's integral is not explicitly evaluated.
            Note, that the resulting forms of these two approaches are equivalent; by evaluating the outgoing flux in \cref{eq:MOC:FSA:Angular Flux Solution} at the outgoing position, \cref{eq:MOC:FSA:Track-Averaged Angular Flux Implicit} can be put into the form of \cref{eq:MOC:FSA:Track-Averaged Angular Flux Explicit}.
            By substituting the track-averaged angular flux in \cref{eqs:MOC:FSA:Region-Averaged Flux Moments Definition}, the flux moments can be evaluated, and used to compute the source.
            A transport calculation may be carried out using the source iteration algorithm defined by \cref{alg:NTT:Source Iteration}.
        }
        \subsection{Particle Conservation}{\label{ssec:MOC:FSA:Particle Conservation}
            The neutron transport equation, \cref{eq:NTT:Boltzmann Transport}, is a statement of particle balance within the defined phase-space.
            Previous works \cite{LeTellier2008,Ferrer2018} have examined the \ac{FSMOC} with respect to \emph{particle conservation}.
            \citet{LeTellier2008} defined necessary constraints on the directional quadrature and the characteristic tracks (trajectories) in order to ensure particle conservation for the anisotropic \ac{FSMOC}.
            The constraints can be found by requiring
            \begin{equation}\label{eq:MOC:FSA:Anisotropic Source Conservation}
                \rfourpi\MOCIntegral{\SH\srcF[mi]} = \srcF[i,\ell][g,n].
            \end{equation}
            Substituting \cref{eq:MOC:FSA:Source Shape} into \cref{eq:MOC:FSA:Anisotropic Source Conservation}, requires that
            \begin{subequations}\label[subeqs]{eqs:MOC:FSA:Anisotropic Constraints}
                \begin{equation}\label{eq:MOC:FSA:Quadrature Constraint}
                    \suml[m]\wt[m]\SH[\ell][n][\dirm]\SH[\ell'][n'][\dirm] = \delta_{\ell\ell'}\delta_{nn'},
                \end{equation}
                and
                \begin{equation}\label{eq:MOC:FSA:Track Constraint}
                    \suml[k]\nsegl\tA[mki] = V_i.
                \end{equation}
            \end{subequations}
            \Cref{eq:MOC:FSA:Quadrature Constraint} is a constraint on the directional quadrature, requiring orthogonality of the real spherical harmonics \cite{LeTellier2008}.
            \Cref{eq:MOC:FSA:Track Constraint} requires that \emph{at least} direction-dependent renormalization, \cref{eq:MOC:Direction-Dependent Renormalization}, be used.

            If the constraints on directional quadrature, and characteristic tracks, are satisfied several simplifications to \cref{eqs:MOC:FSA:Region-Averaged Flux Moments Definition} are possible.
            \begin{subequations}\label[subeqs]{eqs:MOC:FSA:Region-Averaged Flux Moments}
                \begin{equation}\label{eq:MOC:FSA:Region-Averaged Scalar Flux}
                    \sflux = \frac{\srcF}{\xst} + \frac{\fourpi}{V_i\xst}\suml[m]\wt[m]\suml[k]\tA[mki]\dflux,
                \end{equation}
                \begin{equation}\label{eq:MOC:FSA:Region-Averaged Angular Moments of Flux}
                    \afluxmom[g] = \frac{\srcF[i,\ell][g,n]}{\xst} + \frac{\fourpi}{V_i\xst}\suml[m]\wt[m]\SH[\ell][n][\dirm]\suml[k]\tA[mki]\dflux,
                \end{equation}
                where
                \begin{equation}\label{eq:MOC:FSA:Delta Flux}
                    \dflux \defined \afluxin - \afluxout.
                \end{equation}
            \end{subequations}
        }
        \subsection{Isotropic Simplifications}{\label{ssec:MOC:FSA:Isotropic Simplifications}
            While anisotropic scattering is necessary for accurate calculations, it is also common for isotropic source calculations to be performed.
            Typically, these account for anisotropic behavior by using the \ac{TCP0} approximation \cite{YamamotoAnisotropy2008}.
            While not as accurate as truly anisotropic calculations, use of an isotropic source results in significantly fewer calculations, and allows for additional simplifications to be made.

            \Cref{eq:MOC:FSA:Anisotropic Source Conservation} is now only of concern for the isotropic component of the source.
            This results in the following constraint,
            \begin{equation}\label{eq:MOC:FSA:Isotropic Track Constraint}
                \suml[m]\wt[m]\suml[k]\nsegl\tA[mki] = V_i,
            \end{equation}
            which is equivalent to the direction-independent renormalization, given by \cref{eq:MOC:Region Renormalization}.
            These isotropic calculations become significantly less expensive, as only the scalar flux needs to be computed.
        }
        \subsection{Applications}{\label{ssec:FSA:Applications}
            The \ac{FSMOC} has been utilized in many \ac{MOC} production codes \cite{Halsall1980,Hong1998,Saji2000,Smith2002,Sugimura2006,Masiello2008,Boyd2014,Collins2016}.
            However, previous studies on the \ac{FSMOC} have found that a fine mesh must be used to obtain accurate results, particularly in the presence of control rods or blades, strong absorber rods, gadolinia poisoned fuel rods \cite{Petkov1999}, as well as in the presence of large reflector regions (such as in critical experiments) \cite{Ferrer2016}.
            As the number of mesh elements increase, so does the number of track-segments (on which the \ac{MOC} computations are performed).
            This results in large run-times, and has motivated the development of \acfp{LSA} to the \ac{MOC}, that are discussed in detail in \cref{sec:MOC:LSA}.
        }
    }
    \section{The Linear-Source Approximation}{\label{sec:MOC:LSA}
        \subsection{Overview}{\label{ssec:MOC:LSA:Overview}
            The \acf{LSA}, in the \ac{MOC}, assumes the shape of the source along a characteristic track-segment is linear.
            There has long been motivation for the development of \acp{LSA} for the \ac{MOC}, as previous work \cite{Larsen1980} indicated that a spatially linear source was able to achieve faster computational performance in \ac{SN} calculations.
            There have been many different variants of this approximation.
            The first instance of the \ac{LSA} was the \emph{gradient source approximation} introduced by \citet{Halsall1993}.
            This early \ac{LSMOC} was based on the averaging of the angular flux gradient along tracks, and was implemented in the WIMS \cite{Halsall1993}, and PEACH \cite{Tang2009} \ac{MOC} transport codes.
            These averaged gradients were then used as estimates to the gradient of the scalar flux, which were used to compute the source shape as spatially linear.

            \citeauthor{Petkov1998} devised a \ac{LSA} that estimated the gradient of the scalar flux based on the $P_1$ approximation in the MARIKO code \cite{Petkov1998,Petkov1999}.
            In this approximation, the gradient of the scalar flux is computed from the neutron current, the total cross section, and the linearly anisotropic scattering matrix:
            \begin{equation}\label{eq:MOC:LSA:Current2Gradient}
                \grad\sflux \approx -3\left(\xst\current - \suml[\gprime]\xss[1]\current[i][\gprime]\right).
            \end{equation}
            A similar approach, using the diffusion approximation to compute the scalar flux gradient, was used in the so called ``quasi-linear'' source implemented by \citet{Rabiti2009}.
            In this approach, the $\xss[1]$ matrix is diagonalized, turning the $P_1$ approximation into the diffusion approximation.
            Due to their basis on the $P_1$ and diffusion approximations, these early \acp{LSA} are inaccurate in situations where more transport-like effects are present.
            It can be shown, even in simple cases, that this approximation can be predict the opposite direction for the scalar flux gradient.
            % NOTE[show TCP0 work here?]

            \citet{Santandrea2002} introduced the positive linear and nonlinear surface characteristics scheme, which constructed a linear source by interpolating between source values on the surfaces of cell regions.
            Various improvements have been made to this surface characteristics scheme for conservation \cite{Santandrea2002}, as well as coupling in APOLLO2 \cite{Santandrea2008}.
            \citet{LeTellier2006} introduced a simplification to the linear characteristics scheme for conservation, by using a diamond-differencing scheme.
            This work was extended by \citet{Hebert2016}, to include higher-order diamond difference schemes, as well as allowing for acceleration \cite{Hebert2017}.

            The most recent \ac{LSA} examined in this work was introduced as a 2-D general high-order method for unstructured meshes by \citet{Masiello2009}.
            The approximation uses track-based integration, defined in \cref{ssec:MOC:Track-Based Integration}, in order to compute spatial moments of the angular flux.
            This \ac{LSA} was shown to reduce memory and computation times in 3-D \ac{MOC} calculations \cite{Chai2009}.
            The general method was simplified in the case of the isotropic and anisotropic \ac{LS} by \citet{Ferrer2016}; this also introduced the ``LS-P0'' method in which the isotropic source is spatially linear, but the anisotropic source components are spatially uniform within each cell.
            This \ac{LSA} was also shown to be consistent with particle conservation, under certain constraints, and shown to be compatible with \ac{CMFD} acceleration \cite{Ferrer2018}.

            This thesis work has made extensive use of this \ac{LSA}, and has made improvements upon the method.
            For this reason, in the following section the formulation prior to the work of this thesis is derived.
        }
        \subsection{Derivation}{\label{ssec:MOC:LSA:Derivation}
            The moment-based \ac{LSA} assumes the shape of the source, $\source[mi][g][\loc]$, is spatially linear within each cell, $\Region$.
            This can be expressed as
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:Source Shape}
                \begin{equation}\label{eq:MOC:LSA:Source Shape}
                    \source[mi][g][\loc] \approx \srcF[mi] + \loc\vdot\srcL[][mi],
                \end{equation}
                where $\srcL[][mi]$ is a column vector of source spatial expansion coefficients,
                \begin{equation}
                    \srcL[][mi] \defined\begin{bmatrix}\srcL[x][mi]\\\srcL[y][mi]\\\srcL[z][mi]\end{bmatrix},
                \end{equation}
                and $\loc$ is the position in \emph{local} coordinates.
            \end{subequations}
            A similar spatial expansion of the angular moments of the flux can be performed,
            \begin{equation}\label{eq:MOC:LSA:Flux Expansion}
                \fluxA(\loc) = \fluxF + \loc\vdot\fluxL,
            \end{equation}
            the source can then be expressed as
            \begin{equation}\label{eq:MOC:LSA:Linear Source Computation}
                \source[mi][g][\loc]
                    = \suml[\gprime]\suml[\ell=0][L]\suml[n=-\ell][\ell]\SH[\ell][n][\dirm]\xss[\ell]\fluxA[\gprime](\loc)
                    + \frac{\spect}{\keff}\suml[\gprime]\nufis\sflux[\gprime](\loc),
            \end{equation}
            and the linear expansion coefficients are explicitly given by
            \begin{equation}\label{eq:MOC:LSA:Linear Source Coefficients}
                \srcL[][mi]
                    = \suml[\gprime]\suml[\ell=0][L]\suml[n=-\ell][\ell]\SH[\ell][n][\dirm]\xss[\ell]\fluxL[\gprime]
                    + \frac{\spect}{\keff}\suml[\gprime]\nufis\sfluxL[\gprime].
            \end{equation}

            In the spatial moment-base \ac{LSA}, it is convenient to define the spatially linear source (and flux) in terms of a cell-local coordinate system.
            Allow $\Loc$ to be the position variable in the global coordinate system, the local coordinates are then defined as
            \begin{equation}\label{eq:MOC:LSA:Global to Local Coordinates}
                \loc = \Loc - \centroid[\Loc][mi],
            \end{equation}
            where $\centroid[\Loc][mi]$ is the numerical centroid of the cell $i$.

            These numerical centroids can be defined as either direction-dependent, or direction-independent, which will have implications on particle conservation, as is discussed in \cref{ssec:MOC:LSA:Particle Conservation}.
            The direction-dependent centroids are defined by
            \begin{equation}\label{eq:MOC:LSA:Direction-Dependent Centroids}
                \centroid[\Loc][mi] \defined \MOCSingleAngleIntegral{\Loc} = \frac{1}{V_i}\suml[k]\tA[mki]\nsegl\locCent[\Loc],
            \end{equation}
            where $\locCent[\Loc]$ is the global coordinate vector of the track-segment mid-point.
            Similarly, the direction-independent centroids are defined by
            \begin{equation}\label{eq:MOC:LSA:Direction-Independent Centroids}
                \centroid[\Loc][i] \defined \rfourpi\MOCIntegral{\Loc} = \frac{1}{V_i}\suml[m]\wt\suml[k]\tA[mki]\nsegl\locCent[\Loc].
            \end{equation}

            Following the same approach as the \ac{FSMOC} derivation, in \cref{ssec:MOC:FSA:Derivation}, computing the source requires the region-averaged flux moments, $\fluxF$, and the flux expansion coefficients, $\fluxL$.
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:Region-Averaged Flux Moments Definitions}
                The region-averaged flux moment can be found using the same definition as previously,
                \begin{equation}\label{eq:MOC:LSA:Region-Averaged Flux Moment Definition}
                    \fluxF \defined \MOCIntegral{\SH \aflux[][g][]} = \frac{\fourpi}{V_i}\suml[m]\wt\SH[\ell][n][\dirm]\suml[k]\tA[mki]\nsegl\MOCTrackIntegral{\aflux[][g][]}.
                \end{equation}
                In order to determine the spatial expansion coefficients of the flux moments, \cref{eq:MOC:LSA:Flux Expansion} is operated on by $\MOCIntegral{\SH\loc(\vdot)}$.
                Recognizing that this should be directly proportional to angular flux operated on by $\MOCIntegral{\SH\loc\aflux[][g][]}$, a system of equations is found
                \begin{equation}\label{eq:MOC:LSA:Moment to Expansion Coefficient}
                    \M\fluxL = \MOCIntegral{\SH\loc\aflux[][g][]},
                \end{equation}
                where
                \begin{equation}\label{eq:MOC:LSA:Geometric Moments}
                    \M \defined \MOCIntegral{\loc^T\loc}.
                \end{equation}
                The spatial angular flux moments, $\MOCIntegral{\SH\loc\aflux[][g][]}$, are then defined as
                \begin{equation}\label{eq:MOC:LSA:Revion-Averaged Spatial Angular Flux Moments Definition}
                    \MOCIntegral{\SH\loc\aflux[][g][]} = \frac{\fourpi}{V_i}\suml[m]\wt\SH[\ell][n][\dirm]\suml[k]\tA[mki]\nsegl\left(\locIn\MOCTrackIntegral{\aflux[][g][]} + \dirm\MOCTrackIntegral{\nlen\aflux[][g][]} / \renorm[mi]\right).
                \end{equation}
            \end{subequations}

            In order to evaluate the flux moments defined in \cref{eqs:MOC:LSA:Region-Averaged Flux Moments Definitions}, the track-averaged angular flux values, $\MOCTrackIntegral{\aflux[][g][]}$, and $\MOCTrackIntegral{\nlen\aflux[][g][]}$, must be determined.
            First, the transport equation must be put into characteristic form, using \cref{eq:MOC:Renormalized Location Variable} the spatially expanded source, \cref{eq:MOC:LSA:Source Shape}, can be defined along the characteristic.
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:Characteristic Form}
                The characteristic transport equation becomes
                \begin{equation}\label{eq:MOC:LSA:Characteristic Form}
                    \left[\deriv{}{\nlen} + \xst\right]\aflux = \tsrcF + \tsrcL\left(\nlen - \frac{\nsegl}{2}\right),
                \end{equation}
                where
                \begin{equation}\label{eq:MOC:LSA:Track Average Source}
                    \tsrcF \defined \rfourpi\left[\srcF[mi] + \locCent \vdot \srcL[][mi]\right],
                \end{equation}
                \begin{equation}\label{eq:MOC:LSA:Track Linear Source}
                    \tsrcL \defined \rfourpi\left[\frac{\dirm\vdot\srcL[][mi]}{\renorm[mi]}\right],
                \end{equation}
                and $\locCent$ is the local-coordinate centroid of the track-segment.
            \end{subequations}
            Substituting this assumed source shape (linear) into the generic \ac{MOC} solution, given by \cref{eq:MOC:MOC Generic Solution}, the angular flux along a track-segment is found to be
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:Angular Flux Solution}
                \begin{equation}\label{eq:MOC:LSA:Angular Flux Solution}
                    \aflux = \afluxin + \left(\frac{\tsrcF}{\xst} - \afluxin\right)F_1(\opt) + \frac{\tsrcL}{2(\xst)^2}F_2(\opt),
                \end{equation}
                where
                \begin{equation}\label{eq:MOC:LSA:F1}
                    F_1(\opt) \defined 1 - \exp(-\opt),
                \end{equation}
                and
                \begin{equation}\label{eq:MOC:LSA:F2}
                    F_2(\opt) \defined 2[\opt-F_1(\opt)] - \segopt F_1(\opt).
                \end{equation}
            \end{subequations}

            As discussed in \cref{ssec:MOC:FSA:Derivation}, there are two \emph{equivalent} methods with which one could determine the track-averaged angular flux values.
            The original derivation of the \ac{LSA} method by \citet{Ferrer2016} used the \emph{implicit} definition for the track-average angular flux, but the \emph{explicit} definition for the first spatial moment of the angular flux.
            In \cref{ch:Improved Linear Source Formulation for Multi-physics and 2D/1D Applications}, the implicit definition is taken for the first spatial moment of the angular flux as well, which allows for additional improvements for the method in multi-physics and 2D/1D applications.
            For the remainder of this section, the formulation as it was originally derived by \citet{Ferrer2016} is shown, using the explicit form of $\MOCTrackIntegral{\nlen\aflux[][g][]}$.

            The implicitly defined track-average flux is given by operating on \cref{eq:MOC:LSA:Characteristic Form} by $\MOCTrackIntegral{(\vdot)}$, and the explicitly defined first spatial moment of the angular flux is given by operating on \cref{eq:MOC:LSA:Angular Flux Solution} by $\MOCTrackIntegral{\nlen(\vdot)}$.
            These are shown in \cref{eqs:MOC:LSA:Track-Averaged Moments}.
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:Track-Averaged Moments}
                \begin{equation}\label{eq:MOC:LSA:Track-Averaged Angular Flux}
                    \MOCTrackIntegral{\aflux[][g][]} = \frac{\tsrcF}{\xst} + \frac{\dflux}{\segopt},
                \end{equation}
                and
                \begin{equation}\label{eq:MOC:LSA:Track-Averaged Linear Angular Flux}
                    \MOCTrackIntegral{\nlen\aflux[][g][]} =
                      \afluxin\frac{\nsegl}{2} + \left(\frac{\tsrcF}{\xst} - \afluxin\right)\frac{G_1(\segopt)}{\xst}
                      + \frac{\tsrcL}{2(\xst)^2}\nsegl G_2(\segopt).
                \end{equation}
            \end{subequations}
            Here
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:G Functions}
              \begin{equation}\label{eq:MOC:LSA:G1}
                  G_1(\segopt) \defined 1 + \frac{\segopt}{2} - \left(1+\frac{1}{\segopt}\right)F_1(\segopt),
              \end{equation}
              and
              \begin{equation}\label{eq:MOC:LSA:G2}
                  G_2(\segopt) \defined \frac{2}{3}\segopt - \left(1+\frac{2}{\segopt}\right)G_1(\segopt).
              \end{equation}
            \end{subequations}

            % Ferrer & Rhodes derivation
            The original derivation further simplified \cref{eqs:MOC:LSA:Region-Averaged Flux Moments Definitions} into the following forms.
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:Region-Averaged Flux Moments}
                \begin{equation}\label{eq:MOC:LSA:Region-Averaged Angular Moments}
                    \fluxF = \frac{\fourpi}{\xst V_i}\suml[m]\wt[m]\SH[\ell][n][\dirm] \xst \FerrerFlatPsi,
                \end{equation}
                \begin{equation}\label{eq:MOC:LSA:Region-Averaged Spatial Moments}
                  \MOCIntegral{\loc\SH\aflux[][g][]} = \frac{\fourpi}{\xst V_i}\suml[m]\wt[m]\SH[\ell][n][\dirm] \xst \left(\FerrerLinearPsi + \dirm\FerrerLinearPsiHat/\renorm\right),
                \end{equation}
            \end{subequations}
            where
            \begin{subequations}{\label[subeqs]{eqs:MOC:LSA:Ferrer Psis}}
                \begin{equation}\label{eq:MOC:LSA:Ferrer Flat Psi}
                    \FerrerFlatPsi \defined
                      \frac{1}{\xst}\left[
                          \frac{\srcF[mi]}{\fourpi}\suml[k]\tA\nsegl
                        + \frac{\srcL[][mi]}{\fourpi}\vdot\suml[k]\tA\locCent\nsegl
                        + \suml[k]\tA\dflux
                      \right],
                \end{equation}
                \begin{equation}\label{eq:MOC:LSA:Ferrer Linear Psi}
                  \begin{aligned}
                    \FerrerLinearPsi \defined
                      \frac{1}{\xst}\Bigg[
                          &\left(\suml[k]\tA\nsegl\locIn\right)\frac{\srcF[mi]}{\fourpi}
                        + \left(\suml[k]\tA\nsegl\locIn(\locCent)^T\right)\frac{\srcL[][mi]}{\fourpi}\\
                        &+ \suml[k]\tA\locIn\dflux
                      \Bigg],
                  \end{aligned}
                \end{equation}
                and
                \begin{equation}\label{eq:MOC:LSA:Ferrer Linear PsiHat}
                    \FerrerLinearPsiHat \defined
                      \frac{1}{\xst}\left[
                          \frac{\srcF[mi]}{\fourpi}\FerrerAnisotropicFlatC
                         +\frac{\srcL[][mi]}{\fourpi}\vdot\FerrerAnisotropicLinearC
                         +\suml[k]\tA\nsegl\afluxin H(\segopt)
                      \right],
                \end{equation}
            \end{subequations}
            where
            \begin{subequations}
              \begin{equation}\label{eq:MOC:LSA:Ferrer Ansitropic Flat C}
                \FerrerAnisotropicFlatC \defined
                  \frac{1}{\xst}\suml[k]\tA\nsegl G_1(\segopt),
              \end{equation}
              \begin{equation}\label{eq:MOC:LSA:Ferrer Ansitropic Linear C}
                \FerrerAnisotropicLinearC \defined
                  \frac{1}{\xst}\suml[k]\tA\nsegl\left(
                      \locCent G_1(\segopt) + \dirm\frac{\segl}{2}G_2(\segopt)
                  \right),
              \end{equation}
            \end{subequations}
            and
            \begin{equation}\label{eq:MOC:LSA:H Function}
              H(\segopt) \defined \frac{\segopt}{2} - G_1(\segopt).
            \end{equation}

            The $\FerrerAnisotropicFlatC$ and $\FerrerAnisotropicLinearC$ are dependent on both the energy group, $g$, and direction $m$, for each region, $i$.
            If these terms are stored, this leads to considerable memory usage, and will often use more memory than the flux moments that are of interest.
            If cross sections are constant in the problem (no feedback, or 2D/1D transverse leakage splitting), these coefficients can be pre-computed once at the outset of the simulation.
            However, if this is not the case, these coefficients must be re-evaluated each time there is a change in cross sections.
            The re-evaluation of these coefficients can lead to significant overhead.
            In cases with \ac{TH} feedback, cross sections typically change each iteration.
        }
        \subsection{Particle Conservation}{\label{ssec:MOC:LSA:Particle Conservation}
            When considering particle conservation, use of the \ac{LSA} results in additional constraints on the calculations.
            Similarly to \cref{ssec:MOC:FSA:Particle Conservation}, the track-based integration of the source must exactly integrate to the spatial and angular moments of the source.
            The conservation of spatial moments is the basis of this \ac{LSA} \cite{Ferrer2018}, so this constraint is satisfied without additional constraints on the method.
            The angular moment constraint is expressed as
            \begin{equation}\label{eq:MOC:LSA:Angular Moment Constaint}
                \rfourpi\MOCIntegral{\SH\source[mi][g][\loc]} = \srcF[i,\ell][g,n].
            \end{equation}
            In addition to the constraints introduced in \cref{ssec:MOC:FSA:Particle Conservation}, namely direction-dependent renormalization, and directional quadrature restrictions, there is a constraint on the definition of the local coordinate system:
            \begin{equation}\label{eq:MOC:LSA:Anisotropic Coordinate Constraint}
                \MOCSingleAngleIntegral{\loc} = 0.
            \end{equation}
            This is equivalent to stating that the local coordinate system must be defined with respect to direction-dependent global centroids, as is given by \cref{eq:MOC:LSA:Direction-Dependent Centroids}.
        }
        \subsection{Isotropic Simplifications}{\label{ssec:MOC:LSA:Isotropic Simplifications}
            \citet{Ferrer2016} suggested that allowing only the flat source components to consider anisotropic scattering has performance benefits, while not significantly affecting accuracy.
            It was demonstrated for the \acf{BandW} experiments \cite{Hoovler1980} that considering anisotropic scattering only with spatially flat flux moments resulted in approximately 10 pcm error.
            Furthermore, by making this simplification, run-times were reduced significantly (up to 45\%), while memory savings were even more significant (up to 89\%) \cite{Ferrer2016}.

            As stated in \cref{ssec:MOC:FSA:Isotropic Simplifications}, it is very common in reactor simulations to use \ac{TCP0} cross-sections (which are isotropic).
            Assuming isotropic scattering, \cref{eqs:MOC:LSA:Region-Averaged Flux Moments} become
            \begin{subequations}\label[subeqs]{eqs:MOC:LSA:Isotropic Region-Averaged Flux Moments}
              \begin{equation}\label{eq:MOC:LSA:Isotropic Scalar Flux}
                \sflux = \frac{\srcF}{\xst} + \frac{\fourpi}{\xst V_i}\suml[m]\wt[m]\suml[k]\tA\dflux,
              \end{equation}
              \begin{equation}\label{eq:MOC:LSA:Isotropic Spatial Moments of Flux}
                \MOCIntegral{\loc\aflux[][g][]} =
                    \C\frac{\srcL}{\xst}
                  + \frac{\fourpi}{\xst V_i}\suml[m]\wt\suml[k]\tA\left[
                        \locIn\dflux + \dirm\segl\afluxin H(\segopt)
                    \right],
              \end{equation}
            \end{subequations}
            where
            \begin{equation}\label{eq:MOC:LSA:C Matrix}
              \C \defined
                \frac{1}{\xst V_i}\suml[m/2]\wt\suml[k]\tA\dirm\dirm^{T}\segl^2G_2(\segopt)
                + \frac{2}{V_i}\suml[m/2]wt\suml[k]\tA\loc\loc^T\nsegl.
            \end{equation}

            These $\C$ coefficients are no longer dependent on the direction, but still require significant memory usage; using more than the memory requirements of the scalar flux coefficients.
            However, these coefficients are still dependent on the energy group, and the same inefficiencies mentioned previously are present if cross sections are not constant through the simulation.
        }
        \subsection{Applications}{\label{ssec:MOC:LSA:Applications}
            Various different \acp{LSA} to the \ac{MOC} have been developed and implemented in transport codes \cite{Halsall1993,Petkov1999,Santandrea2002,Tang2009,Rabiti2009,Boyd2014,Ferrer2016,Fitzgerald2018}.
            Results have indicated that by using a \ac{LSA}, the spatial mesh discretization can be made coarser, relative to the \ac{FSA}, while maintaining transport accuracy.
            Although each segment calculation is more expensive when using a \ac{LSA}, the number of calculations (due to the coarser spatial mesh) can be significantly reduced, leading to reduced run-times.
            Additionally, the reduction in spatial mesh elements generally reduces the amount of memory used by the calculation.
        }
    }
    \section{Parallelism}{\label{sec:MOC:Parallelism}
        High-fidelity transport methods, such as the \ac{MOC}, can require significant computational resources for full core calculations; this is particularly true for 3-D calculations.
        While processing power has increased exponentially since the \ac{MOC} was first conceived in 1972 \cite{Askew1972}, since the early 2000's, single-core processing power has largely leveled off.
        System architectures, as well as code design, have become more focused on \emph{parallel} computations.
        Previous works \cite{Kochunas2013} made significant progress in the efficient parallelization of the \ac{MOC}.

        \citet{Kochunas2013} developed a hybrid-parallel algorithm for the \ac{MOC} that included thread-based parallelism over characteristic tracks, as well as spatial and angular decomposition.
        This work showed that the \ac{MOC} was able to scale well up to 10000's of processors.
        While this work is important, and has led to significant advancement, the use of 1000's of processors is not feasible for industrial use.
        It is thus the author's opinion that the primary focus of research on 3-D \ac{MOC} techniques should be on serial efficiency, such as the \acf{LSA} (\cref{ch:Improved Linear Source Formulation for Multi-physics and 2D/1D Applications}), and macroray (\cref{ch:MacroRay Three-Dimensional Ray-tracing Technique});
        however, moderate levels of parallelism are feasible for industry, and so more efficient use of parallel resources should also be a focus of research (\cref{ch:Spatial Decomposition}).

        In \ac{MOC} calculations, each characteristic track calculation is nearly independent from others; previous works have indicated that loops over characteristic tracks can be parallelized efficiently by using threads on traditional \acp{CPU} \cite{Kochunas2013} or on \acp{GPGPU} \cite{Boyd2014}.
        This type of parallelism is called \emph{shared-data parallelism}, as data is shared between the parallel threads.

        Large neutronics calculations may require significant amounts of memory, and thus \emph{distributed-data parallelism} is necessary.
        In general, this type of parallelism separates (partitions) a domain of the problem, and separate computing nodes are assigned a subdomain.
        Only data for the assigned subdomain is stored, and thus whole-core simulations become possible; additionally, because each subdomain can be processed in parallel, overall runtimes typically decrease with increasing numbers of subdomains (processors).

        MPACT has the capabilities for domain decomposition/parallelism over two separate domains: space and direction.
        In MPACT, each discrete direction has an easily calculable amount of work, and the decomposition is trivial; in general the same cannot be said of the spatial domain.
        As part of this thesis work, a more efficient method of spatial decomposition has been investigated and developed in MPACT \cite{Fitzgerald2019a}.
        Details on the spatial decomposition techniques used in this work are given in \cref{ch:Spatial Decomposition}.
    }

    % References
    \printbibliography
}